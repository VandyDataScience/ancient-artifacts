---
title: "47-generalized-performance-metrics"
output: html_document
---

```{r}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

calculate_best_performance_metrics <- function (fold_metrics, best_params) {
  #get metrics
  best_fold_metrics <- fold_metrics %>%
  filter(.config==best_params$.config[[1]])

#plot
best_glmnet_fold_metrics %>%
  mutate(facet_val = if_else(.metric== 'roc_auc' | .metric=='pr_auc' | .metric=='f_meas', 'Aggregate metrics', 'Confusion matrix metrics')) %>%
  ggplot(aes(x=.metric, y=.estimate, fill=.metric)) +
  geom_boxplot(outlier.shape = NA, na.rm=TRUE) +
  geom_jitter(aes(x=.metric, y=.estimate), na.rm=TRUE) +
  facet_grid(cols=vars(facet_val), scales='free') + #just to get on separate plots
  labs(title='Distribution of cross validation metrics for best hyperparameter set',
       subtitle='By metric',
       x='metric',
       y='metric estimate') +
  theme(legend.position = "none")

return (best_fold_metrics)
}

```