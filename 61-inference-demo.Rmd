---
title: "61_inference_demo"
output: html_notebook
---

Provide a demo for using inference functions on the set of test data. 

***The 40 and 50 notebook must have been run and glmnet, xgboost, and random forest RData must have been loaded in***
***NOTE: This demo uses test_data and glmnet modeling  both of which can be adjusted for a new data set with a different model***


```{r xgb specific modeling packages, results='hide'}
pacman::p_load(xgboost)
```

# Validate prediction 
```{r validate prediction dataframe }
#uses function defined in 10 to validate the data to be predicted on
validate_data(test_data)

```

# Predict using all loading models

```{r predict on the data using the provided models}

glmnet_pred_frame <- predict_with_models(glmnet_final_fit, best_glmnet_params, test_data)
glmnet_pred_frame
```

#Identify particles which require review 

```{r identify questionable particles}
glmnet_questionable <- review_particles_questionable(glmnet_pred_frame)
glmnet_questionable
```

```{r identify mismatched particles across models}

xgb_pred_frame <- predict_with_models(xgb_final_fit, best_xgb_params, test_data)
rf_pred_frame <- predict_with_models(rf_final_fit, best_rf_params, test_data)

combined_pred_frame <- combine_prediction_frames(glmnet_pred_frame, xgb_pred_frame, rf_pred_frame)
combined_pred_frame

mismatched_particles <- review_particles_mismatch(combined_pred_frame)
mismatched_particles

```



#Output the percentage of microdebitage estimated in the sample

```{r percentage microdebitage function}

glmnet_percent <- percent_microdebitage(glmnet_pred_frame)
glmnet_percent

```