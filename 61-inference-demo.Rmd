---
title: "61_inference_demo"
output: html_notebook
---

Provide a demo for using inference functions on the set of test data. 

***The 40 and 50 notebook must have been run and glmnet RData must have been loaded in***
***NOTE: This demo uses test_data and glmnet modeling  both of which can be adjusted for a new data set with a different model***

# Validate prediction 
```{r validate prediction dataframe }
#uses function defined in 10 to validate the data to be predicted on
validate_data(test_data)

```

# Predict using all loading models

```{r predict on the data using the provided models}

glmnet_pred_frame <- predict_with_models(glmnet_final_fit, best_glmnet_params, test_data)
```

#Identify particles which require review 

```{r identify particles of concern}

glmnet_mismatch <- review_particles_mismatch(glmnet_pred_frame)
glmnet_questionable <- review_particles_questionable(glmnet_pred_frame)
```

#Output the percentage of microdebitage estimated in the sample

```{r percentage microdebitage function}

glmnet_percent <- percent_microdebitage(glmnet_pred_frame)
glmnet_percent


percent_microdebitage <- function(pred_frame) {
  
  
 microdeb_count <- sum(pred_frame$.pred_class == "exp") 
    
 totalpart_count <- sum(pred_frame$.pred_class == "exp" ) + sum(pred_frame$.pred_class == "site" )

  return( (microdeb_count / totalpart_count) )
  
}
```